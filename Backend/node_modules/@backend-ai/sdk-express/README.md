# @backend-ai/sdk-express

**Backend AI SDK for Express.js** - Automatically discover and register your Express routes as AI-executable tools.

## ğŸŒŸ Features

- âœ… **Zero-code integration** - Just initialize and go
- ğŸ¤– **AI-powered schema generation** - Uses Gemini to understand your APIs
- ğŸ” **Automatic route discovery** - Scans your Express app automatically
- ğŸ“¡ **gRPC executor** - Fast, type-safe  tool execution
- ğŸ¯ **Framework-agnostic Core** - Works with any backend via adapters

## ğŸ“¦ Installation

```bash
npm install @backend-ai/sdk-express
```

## ğŸš€ Quick Start

```javascript
const express = require('express');
const { BackendAI } = require('@backend-ai/sdk-express');

const app = express();

// Define your routes as usual
app.get('/products', (req, res) => {
  res.json({ products: [] });
});

app.post('/orders', (req, res) => {
  const { userId, items } = req.body;
  res.json({ orderId: 123, status: 'created' });
});

// Initialize Backend AI SDK
BackendAI.init(app, {
  adapterId: 'my-express-app',
  tenantId: 'tenant_001',
  coreUrl: 'localhost:50051',
});

app.listen(3000, () => {
  console.log('Server running on port 3000');
});
```

That's it! Your Express routes are now discoverable by AI agents.

## âš™ï¸ Configuration Options

```typescript
interface BackendAIOptions {
  /** Unique identifier for this adapter instance */
  adapterId: string;
  
  /** Tenant ID for multi-tenancy support */
  tenantId: string;
  
  /** Core service URL (e.g., 'localhost:50051') */
  coreUrl: string;
  
  /** Port for the gRPC executor server (default: 6000) */
  executorPort?: number;
  
  /** Auto-discover routes on initialization (default: true) */
  autoDiscover?: boolean;
  
  /** Persist schemas to Core database (default: true) */
  persist?: boolean;
  
  /** Gemini API key (optional, uses GEMINI_API_KEY env var) */
  geminiApiKey?: string;
  
  /** Gemini model (default: 'gemini-1.5-flash') */
  geminiModel?: string;
  
  /** Enable verbose logging (default: false) */
  verbose?: boolean;
}
```

## ğŸ” Environment Variables

Create a `.env` file in your project root:

```bash
GEMINI_API_KEY=your_gemini_api_key_here
```

## ğŸ“– How It Works

1. **Route Discovery**: SDK scans your Express app and finds all registered routes
2. **Schema Generation**: Uses Gemini AI to analyze route handlers and generate semantic tool definitions
3. **Registration**: Sends tool definitions to Backend AI Core via gRPC
4. **Execution**: Starts a gRPC server that receives execution requests from AI agents
5. **Execution**: When an agent calls a tool, the SDK executes your Express handler and returns the result

## ğŸ¯ Example Use Case

**Your Express API:**
```javascript
app.post('/orders', (req, res) => {
  const { userId, items } = req.body;
  // Create order logic...
  res.json({ orderId: 42, status: 'created' });
});
```

**AI Agent Interaction:**
```
User: "Order 3 widgets for user 123"
Agent: [Calls express.orders.post with { userId: 123, items: [...] }]
SDK: [Executes your handler with mock req/res]
Agent: "I've created order #42 for you!"
```

## ğŸ› ï¸ Advanced Usage

### Manual Route Discovery

```javascript
const { RouteDiscovery } = require('@backend-ai/sdk-express');

const discovery = new RouteDiscovery();
const routes = discovery.discover(app);

console.log('Discovered routes:', routes);
```

### Custom Schema Generation

```javascript
const { SchemaGenerator } = require('@backend-ai/sdk-express');

const generator = new SchemaGenerator(
  'your-gemini-api-key',
  'gemini-1.5-flash',
  true // verbose
);

const tools = await generator.generateSchemas(routes);
```

### Graceful Shutdown

```javascript
process.on('SIGTERM', async () => {
  await BackendAI.shutdown();
  process.exit(0);
});
```

## ğŸ› Troubleshooting

### No routes discovered

Make sure routes are defined **before** calling `BackendAI.init()`:

```javascript
// âœ… Correct
app.get('/users', handler);
app.post('/orders', handler);
BackendAI.init(app, options);

// âŒ Wrong
BackendAI.init(app, options);
app.get('/users', handler); // Won't be discovered
```

### Gemini API errors

Set `verbose: true` to see detailed logs:

```javascript
BackendAI.init(app, {
  // ...
  verbose: true
});
```

If Gemini is unavailable, SDK will use fallback metadata generation.

## ğŸ“ License

MIT

## ğŸ¤ Contributing

Contributions welcome! Please open an issue or PR.

---

Made with â¤ï¸ by Backend AI Team
